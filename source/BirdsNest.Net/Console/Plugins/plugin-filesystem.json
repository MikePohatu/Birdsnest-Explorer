{
  "name": "filesystem",
  "displayname": "File System",
  "icons": {
    "FS_Folder": "fas fa-folder-open",
    "FS_Datastore": "fas fa-hdd"
  },
  "nodelabels": [
    "FS_Folder",
    "FS_Datastore",
    "FS_BlockedFolder",
    "FS_DfsRoot"
  ],
  "edgelabels": [
    "FS_APPLIES_INHERITANCE_TO",
    "FS_BLOCKED_INHERITANCE",
    "FS_HOSTS"
  ],
  "reports": {
    "fs-orphanedperms": {
      "displayname": "FS Orphaned Permissions",
      "description": "Lists folders with permissions for deleted permissions",
      "query": "MATCH p=(a:AD_Deleted)-[]->(f:FS_Folder) WITH nodes(p) AS items UNWIND items as item RETURN DISTINCT item",
      "propertyfilters": []
    },
    "fs-inheritancedisabled": {
      "displayname": "FS Inheritance Disabled",
      "description": "Lists folders with inherited permissions disabled",
      "query": "MATCH (n:FS_Folder) WHERE n.inheritancedisabled=True return n ORDER BY n.path",
      "propertyfilters": [ "path" ]
    }
  },
  "edgepropertydetails": {
    "GIVES_ACCESS_TO": {
      "properties": [
        { "name": "fsid" },
        { "name": "right" }
      ]
    }
  },
  "nodepropertydetails": {
    "FS_Datastore": {
      "properties": [
        { "name": "comment" },
        { "name": "host" },
        { "name": "name" }
      ],
      "default": "name"
    },
    "FS_Folder": {
      "properties": [
        { "name": "fsid" },
        { "name": "lastpermission" },
        { "name": "lastscan" },
        { "name": "name" },
        { "name": "path" },
        {
          "name": "blocked",
          "description": "Scanner was unable to interogate this folder and further scanning was blocked",
          "type": "boolean"
        },
        {
          "name": "inheritancedisabled",
          "description": "",
          "type": "boolean"
        }
      ],
      "default": "path"
    }
  }
}
